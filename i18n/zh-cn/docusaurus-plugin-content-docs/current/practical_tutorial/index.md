---
title: 基础知识
sidebar_position: 1
---

# 数字转型

## 元数据

### 背景 

   据说，英语中元数据meta一词最早出现于1968年，其是对希腊语前缀"meta-"的粗略翻译，用于表明更抽象层次的事物。尽管元数据一词只有几十年的历史，然而几千年的图书馆管理员们一直在工作中使用着元数据，只不过我们先所谓的“元数据”是历史上被称为"图书馆目录信息"。图书目录中的信息解决了一个十分关键的问题，就是如何帮助用户在图书馆快速地、准确地找到想要的资料。

![](http://dgiot-1253666439.cos.ap-shanghai-fsi.myqcloud.com/shuwa_tech/zh/blog/knowledge/meta-data/1.png)
图为爱尔兰最古老的都柏林圣三一学院图书馆


 图书目录中依然延续至今的信息片段：书名、作者或整理、主题、简介和篇幅。但如今其含有更多的信息，如出版社、出版时间、定价、条形码和上架建议等等。

![](http://dgiot-1253666439.cos.ap-shanghai-fsi.myqcloud.com/shuwa_tech/zh/blog/knowledge/meta-data/2.png)

如今的图书目录采用更多的信息片段。每本著作都有唯一的编码号码（图书馆的书一般带有手写或机打标签），根据某种编码方案（如杜威十进制分类法等）设计的纯数字或字母数字混编字符串，来帮助图书馆用户在书架上准确地快速地找到著作。

试想几种场景，一个藏有几千万册的图书馆没有分类编码存储；著作没有著作名称、作者、简介等；著作封面简介与内容不符；著作没有目录等等。就会出现这样的结果：

+   图书馆无法管理的自己图书，很难统计馆内多少图书、每类图书多少；
    
+   图书馆无法根据大众读者喜好摆放某类图书的位置；
    
+   读者无法找到自己想读的图书；
    
+   读者费时费力地找到了图书，但内容与描述不符；
    
+   读者精疲力尽地找到了图书，但无法快速定位到某些章节；
    
+   读者心平气和地找到了图书，但内容是错误的；
    
+   读者心满意足地找到了图书，但内容是下册的，又必须从上册读起；
    
+   读者喜出望外地找到了图书，但内容是用甲骨文写的，用梵文作的注解（读者看不懂）；
    
+   读者欲哭无泪地找到了图书，但图书馆要下班关门了；
    
+   ......读者崩溃了.....
    

同样道理，若企业没有做好元数据管理，那么数据消费者或数据分析师会面临上述读者的同类困境：找不到数据、找到没有上下文无法理解数据、理解了数据因数据格式无法使用、内容有误导致结果错误、查询性能低、数据加工好已经错过时效等等问题。解决上述困境或管好这些对事物的描述信息都属于元数据管理的概念范畴。

如果没有元数据管理，数据无法被有效地组织起来、被准确地理解、被合理地使用和产出预期的结果，那么数据价值无法发挥出来，于是数据变成了数据负债；如果没有元数据，那么数据的内容和真实性就难以估量，继而可能造成数据价值和可用性的降低。元数据是发挥数据价值的前提，是数据治理的基石。

**1 何为元数据**

“元数据是关于数据的数据”（准确地说这个定义不大实用，且不易被理解）。从数据、信息、知识和智慧人类认知领域的层次结构来讲，数据是通过工具或机器搜集的原始资料。确切地说，数据是原始、未经处理的资料或潜在信息。信息就是经过某种处理并供人使用的数据。知识指的是你知道的事情，也就是经过内化的信息，而智慧则是指了解如何运用知识。**元数据是对潜在信息的**信息**，是关于数据的**更高层次抽象**，是对数据的描述**。

准确的元数据是必不可少的，也是迅速有效地对数据去粗取精的关键。没有元数据，数据就毫无意义，只不过是一堆数字或文字而已。

元数据只是发挥数据价值的充分条件，“酒香也怕巷子深”如制定了合理并严格执行数据标准，通用的易用的模型设计数仓底座，极高的良性循环的数据质量，安全的顺滑的数据访问和数据共享机制和合理的高效的管理流程等，就亟须统一标准的、合理的、易用理解的、易用使用的元数据管理系统，不能把“好酒”（数据）埋没掉，要把数据宣传出去，让更多用户知晓、理解和高效使用，并使数据价值得最大发挥。

同时也应避免言过其实的“金玉其外，败絮其中”即数据不标准、数据质量较差、数据存在异常和形散而神散、重复建设及计算的数仓等等，即使有个华丽的元数据可视化展示，只会换来业务用户更多抱怨。

总之，名副其实是最好的，数据与元数据同步持续良性迭代优化。

元数据应用领域较广，种类甚多， 按照不同应用领域或功能，元数据分类有很多种方法或种类，元数据一般大致可为三类：业务元数据、技术元数据和操作元数据。各自包含内容如下：

**业务元数据：**

+   指标名称、计算口径、业务术语解释、衍生指标等；
    
+   数据概念模型和逻辑模型；
    
+   业务规则引擎的规则、数据质量检测规则、数据挖掘算法等；
    
+   数据血缘和影响分析；
    
+   数据的安全或敏感级别等。
    

**技术元数据：**

+   物理数据库表名称、列名称、列属性、备注、约束信息等；
    
+   数据存储类型、位置、数据存储文件格式或数据压缩类型等；
    
+   数据访问权限、组和角色；
    
+   字段级血缘关系、ETL抽取加载转换信息；
    
+   调度依赖关系、进度和数据更新频率。
    

**操作元数据：**

+   系统执行日志
    
+   访问模式、访问频率和执行时间
    
+   程序名称和描述
    
+   版本维护等
    
+   备份、归档时间、归档存储信息
    

上述只是大致的分为三类，简单地列举常用的元数据信息，其实还包括结构性元数据、保存性和权限元数据等等这里就不一一列举了。  

**2 元数据管理**

元数据也是数据，同样适用数据生命周期管理。元数据生命周期可分为采集、整合、存储、分析、应用、价值和服务几个阶段。

**2.1**

**元数据架构**

元数据战略是关于企业元数据管理目标的说明，也是开发团队的参考框架。元数据战略决定了企业元数据架构。元数据架构可分为三类：集中式元数据架构、分布式元数据架构和混合元数据架构。

+   **集中式元数据架构：**
    

集中式架构包括一个集中的元数据存储，在这里保存了来自各个元数据来源的元数据最新副本。保证了其独立于源系统的元数据高可用性；加强了元数据存储的统一性和一致性；通过结构化、标准化元数据及其附件的元数据信息，提升了元数据数据质量。集中式元数据架构有利于元数据标准化统一管理与应用。

+   **分布式元数据架构**：
    

分布式架构包括一个完整的分布式系统架构只维护一个单一访问点，元数据获取引擎响应用户的需求，从元数据来源系统实时获取元数据，而不存在统一集中元数据存储。虽然此架构保证了元数据始终是最新且有效的，但是源系统的元数据没有经过标准化或附加元数据的整合，且查询能力直接受限于相关元数据来源系统的可用性。

+   **混合式元数据架构**：
    

这是一种折中的架构方案，元数据依然从元数据来源系统进入存储库。但是存储库的设计只考虑用户增加的元数据、高度标准化的元数据以及手工获取的元数据。

这三类各有千秋，但为了更好发挥数据价值，就需要对元数据标准化、集中整合化、统一化管理。如果企业做功能较为完善的数据资产管理平台可采用集中式元数据架构。

**2.2**

**元数据生命周期**

笔者这里以集中式元数据架构为例讲解，通过对数据源系统的元数据信息采集，发送Kafka消息系统进行解耦合，再使用Antlr4开发各版SQL解析器，对元数据信息新增、修改和删除操作进行标准化集中整合存储。在元数据集中存储的基础上或过程中，可提供元数据服务与应用，如数据资产目录、数据地图、集成IDE、统一SQL多处理引擎、字段级血缘关系、影响度分析、下线分析、版本管理和数据价值分析等（这些元数据应用可根据产品经理设计理念进行优化组合，笔者这里拉平排列各功能应用，为了方便讲解各元数据应用模块）。这里就包括了元数据采集、整合、存储、分析、应用等阶段的生命周期。

![](http://dgiot-1253666439.cos.ap-shanghai-fsi.myqcloud.com/shuwa_tech/zh/blog/knowledge/meta-data/3.png)

**3 元数据应用**

**3.1**

**数据资产地图**

数据资产地图包括数据资产目录和血缘关系等。通过对元数据的标准化、加工整合形成数据资产地图。数据资产地图一般可支持全文搜索和模糊查询表信息检索、也支持按照关系查找或按主题域层级查找。一般采集Elasticsearch做元数据信息检索和Neo4J做血缘关系的数据地图。如图：

![](http://dgiot-1253666439.cos.ap-shanghai-fsi.myqcloud.com/shuwa_tech/zh/blog/knowledge/meta-data/4.png)

检索表的元数据信息包括分层信息、分层数据库数量、每层功能描述、数据库表数量、总计存储大小、存储类型、实际表存储位置，表基本信息包括主题分类、所属主题、主题描述、表名称、表数据功能简介、表类型、表创建人、表更新人、创建时间、更新时间、数据更新人、数据更新时间、表预估数据量、表文件大小、表文件个数、表文件存储格式、表压缩格式、数据质量评分、数据热度、更新频率、大致更新完成时间等等。

![](http://dgiot-1253666439.cos.ap-shanghai-fsi.myqcloud.com/shuwa_tech/zh/blog/knowledge/meta-data/5.png)

还包含指标业务元数据信息如下：  

![](http://dgiot-1253666439.cos.ap-shanghai-fsi.myqcloud.com/shuwa_tech/zh/blog/mknowledge/eta-data/6.png)

元数据信息也要包括归档和已销毁的数据记录的元数据信息。归档元数据信息便于数据分析师查找，快速恢复，重新使用挖掘出数据价值。已销毁元数据信息便于数据安全管理。

还包括未采集数据资产管理平台的元数据信息，实际数据还分布在各个源系统的数据，需要抽取、转换、清洗和加载到数据平台的相关流程和ETL工具，便于业务用户元数据查找和数据使用。

**3.2**

**版本管理**

元数据版本管理功能，可对元数据进行发布、查看历史版本、导出历史版本和版本对比操作。在元数据未发布或未正式上线使用时，其他仅有使用权限的用户无法查看此版本信息，这样保证了元数据系统权威性和可靠性。这里同样涉及影响度分析和下线分析元数据应用模块，如表结构变更、删除等下游系统都能做到动态感知提醒或告警功能，下线分析也是如此。  

**3.3**

**血缘关系**

血缘关系包含了集群血缘关系、系统血缘关系、表级血缘关系和字段血缘关系，其指向数据的上游来源，向上游追根溯源。这里指的血缘关系一般是指表级和字段级，其能清晰展现数据加工处理逻辑脉络，快速定位数据异常字段影响范围，准确圈定最小范围数据回溯，降低了理解数据和解决数据问题的成本。

在传统的ETL工具如Informatica、DataStage和开源Kettle中都有相应血缘关系，以informatica ETL工具的表级血缘关系和字段级血缘举例，如图：

![](http://dgiot-1253666439.cos.ap-shanghai-fsi.myqcloud.com/shuwa_tech/zh/blog/knowledge/meta-data/7.png)

（上图：表级血缘关系）  

![](http://dgiot-1253666439.cos.ap-shanghai-fsi.myqcloud.com/shuwa_tech/zh/blog/knowledge/meta-data/8.png)

（上图：字段级血缘关系，也称mapping）  

但只能展现使用这些传统ETL工具的血缘关系，其他方式ETL却无法生成血缘关系。其不灵活也不便于元数据统一集中管理。

大数据时代，大部分企业数据仓库都使用Hive作为数仓存储和ETL数据加工，如果是单一Hive处理引擎，可使用Hive Hook直接解析字段级血缘关系和表级别血缘关系。如果多种计算引擎就使用上述笔者给出技术架构图，通过对不同存储和计算引擎监听动作，使用Antlr4开发各版本SQL解析工具，动态识别元数据信息变更、删除和新增实时或准实时生成集群血缘关系、系统血缘关系、表级血缘关系和字段血缘关系。通过从语法树遍历解析后存储Neo4j图数据

![](http://dgiot-1253666439.cos.ap-shanghai-fsi.myqcloud.com/shuwa_tech/zh/blog/knowledge/meta-data/9.png)

**3.4**

**影响度分析**

影响度分析，也是较为血缘关系应用的一部分，其用来分析数据的下游流向。当系统进行升级改造时，能动态数据结构变更、删除及时告知下游系统。通过依赖数据的影响性分析，可以快速定位出元数据修改会影响到哪些下游系统，哪些表和哪些字段。从而减少系统升级改造带来的风险。

**3.5**

**下线分析**

下线分析和影响度分析功能大致相同，只是应用的侧重点不同，下线分析是根据数据热度，对冷数据或冰数据归档下线时，是否对其他应用造成依赖影响，便于数据归档操作。  

**3.6**

**数据价值分析**

数据价值分析主要是对数据表的被使用情况进行统计，价值密度、访问频次、使用方式、时效性等级等维度评估，从而评级出数据热度，热数据、温数据、冷数据和冰数据。数据价值访问评估一些常用的维度：表的访问频率分析、表分区数据访问分析、跨表访问分析、跨层访问分析、跨库访问分析、字段访问频率分析、表访问用户量分析和分层表访问总量分析等。数据热度应随着时间的推移，数据价值会变化，应动态更新数据热度等级，推动数据从产生到销毁数据生命周期管理。总之，在成本可控、可量化、可管理的前提下，从数据中挖掘出更多有效的数据价值。

**3.7**

**集成IDE**

为了方便数据提供者或数据分析师数据收集、清洗、加工数据的方式不同，集成IDE集成了不同数据开发语言或工具，如集成Python、R、Shell和各版本数据处理引擎的SQL。这是统一的数据开发加工入口。每个元数据应用模块都不是独立的，需要其他元数据应用模块如数据资产地图和数据目录集成，便于快速定位分析师要查找的数据和准确地理解数据，从而提高了数据加工或数据分析的效率。  

**3.8**

**统一SQL路由引擎**

集成IDE开发中提到统一SQL路由引擎，其统一使用HQL语言智能地路由多种执行引擎。这降低了用户熟悉其他SQL的学习成本，其可屏蔽了多种引擎SQL差异，可基于SQL复杂度和成本估算、优先级和各引擎集群空闲程度，把用户提交的SQL路由到合适的执行引擎，如果Hive转换Presto、Spark或其他引擎执行失败，则使用Hive引擎来补救执行，最终都会返回结果。统一SQL路由引擎是使用Antlr4实现的词法文件，具体实现可参考笔者之前的文章，这里给出链接如下：

元数据应用还有很多，如数据探查、元数据对比分析是否存储重复计算和重复存储等等，限于篇幅，不一一列举。  

**4 总结**

如何从数据中探索信息、发现知识，寻找隐藏在数据中的趋势、模式、相关性及隐含规律，都要我们用于更好的数据洞察力，而这种洞察力的基础来自我们对元数据的理解。

元数据是用数据管理数据，是快速查找数据、精确定位数据、准确地理解数据和快速使用数据的关键。元数据管理还须符合数据标准、较高的数据质量、数据安全、数据共享、合理顺滑管理流程。在存储、计算和人力成本合理可控、可管理的前提下，使数据价值得最大发挥，是数据全生命周期管理重要组成部分。是提升数据价值发挥的前提，是数据治理的基石。

## 主数据

### 序言 
主数据管理是企业改善其关键数据资产（如产品数据，资产数据，客户数据，位置数据等）的一致性和质量的必要数据管理活动。

粗略地说，企业数据可以分为三大类：

1.  **交易数据**：记录业务事件
    
    交易数据描述某一时点所发生的业务行为，如客户订单、业绩预测、存货跟踪、销售记录、客服事件等。
    
    除非必要，交易数据一旦被记录，通常不会被更新或维护。  
    
2.  **主数据**：定义业务对象
    
    主数据用于描述业务实体，如产品分类、产品列表、客户列表、地址等。
    
    主数据经常可能发生变化，因此主数据被记录后，需要持续进行维护。  
    
3.  **元数据**：描述数据的数据
    
    若企业数据像一座城市，则元数据就是这座城市的地图。
    
    元数据分为技术元数据与业务元数据，如数据类型、数据定义、数据规则和约束、数据关系、数据所处系统等。
    

这样的大致分类不够精确，但是有利于让你弄清究竟哪些数据属于主数据。毕竟，即使你背熟主数据的定义，你遇到具体问题时，仍不一定能够简单判断哪些数据属于主数据。

有一个“土得掉渣”的说法：企业无非是“人、财、物、产、供、销”六个字\[亦说“人财物产供销存”七要素\]。为了简单起见，可以按照这个简单逻辑，将主数据分为五大类：

![](http://dgiot-1253666439.cos.ap-shanghai-fsi.myqcloud.com/shuwa_tech/zh/blog/knowledge/master-data/1.png)

一、**人**

组织机构的基本信息、组织层次关系、部门设置、编制、人员基本信息等，包括：

1\. 组织机构

2\. 员工

二、**财**

核算体系、会计科目分类、会计明细科目等，包括：

3\. 会计科目表

4\. 财务外部核算体系

5\. 项目

三、**物**

物资和设备管理所需的相关数据，包括基本信息、销售、采购、仓储、成本等：

6\. 生产性和非生产性物料

7\. 通用和专用设备

四、**合作伙伴**  

产供销上下游合作伙伴，包括：

8\. 客户

9\. 供应商

五、**基础数据**

各种公共代码，包括：  

10\. 国家、省市、币种编码等

11\. 银行及金融机构编码

例如，某企业经过业务和系统分析之后，基于以上框架将主数据范围确定为：

![](http://dgiot-1253666439.cos.ap-shanghai-fsi.myqcloud.com/shuwa_tech/zh/blog/knowledge/master-data/2.png)

在确定主数据的具体范围，可以参照主数据的以下基本特征：

1.  **识别唯一性**：
    
    在一个系统、一个平台甚至一个企业范围内，同一数据要求具有唯一的识别标志（编码、名称、特征描述等），用以明确区分业务对象、业务范围和业务的具体细节。
    
    唯一识别信息是业务活动的基础，在业务流转过程中各业务环节完全依赖业务单据中体现的识别标志来定位后续的操作和处理，在业务环节结束后，识别标志又将成为数据分析的主要维度，用来确定分析的范围和方向。
    
2.  **特征一致性**：
    
    随着企业应用范围不断扩大，主数据在不同系统中的重叠、交叉现象极为常见，由于主数据的特征经常被用作业务流程的判断条件和数据分析的维度层次，因此保证主数据的关键特征在不同应用、不同系统中的高度一致是能否实现企业层级的应用整合、统一规范及企业数据平台成功实施的必要条件。
    
3.  **交易稳定性**：
    
    主数据作为用来描述业务对象的关键信息，在业务过程中其识别信息和关键特征会被交易过程中产生的数据继承、引用、复制，但无论交易过程如何复杂和持久，除非主数据本身的特征发生变化，其属性通常不会随交易过程而被修改。
    
    所以当定义主数据时，某些与交易结果密切相关、时效性很强的特征（如大宗客户标记信息）需要同客户的固定属性（如客户名称）区分对待。
    
4.  **长期有效性**：
    
    系统中主数据的有效性，通常贯穿业务对象的整个生命周期、甚至更长。换言之，只要主数据所代表的业务对象继续存在、或仍具有比较意义，则主数据就需要在系统中继续保持有效性。
    
    长期有效性的另一个表现是，主数据失去其效用时系统
    

如今，许多集团型企业拥有数多个单独的应用程序和系统（ERP、CRM等），跨组织或部门的数据很容易变得零散、重复，并且最常见的就是及时性比较差。在这种情况下，准确回答企业绩效指标或KPI就变得很困难。

企业对准确、及时的数据的需求非常迫切，并且随着数据来源的增加，对其进行一致的管理以及使数据定义保持最新状态。因此企业的所有部门都使用一致的数据是一个永无止境的挑战。为了应对这些挑战，企业必须进行主数据管理。

本文将主要讨论以下重点问题：

1.  什么是主数据？
    
2.  为什么管理主数据？
    
3.  主数据管理什么？
    
4.  如何实施主数据？
    
5.  谁需要参与主数据实施？
    



### 什么是主数据？

**1 主数据定义**

**主数据就是企业中多个信息系统共享和使用的数据。**

例如：ERP系统中有“客户主数据”，“项目主数据”和“供应商主数据”。主数据通常是公司的关键资产之一。

为了更全面地回答“什么是主数据？”，我们先看一下在企业中常见的6种数据类型：

1.  **非结构化数据：**可在电子邮件、白皮书、杂志文章、企业内部网站门户、产品规格设计文件、营销资料和PDF文件中找到的数据。
    
2.  **交易数据：**具有历史意义或其他系统需要分析的业务事件。通常与系统交易有关的数据，例如销售、交货、发票、故障单、索赔等。交易数据是使用主数据实体的单位级别的交易。与主数据不同，事务本质上是特定的时间和瞬时数据。
    
3.  **元数据：**关于其他数据的数据。它可以存储在正式的存储库中或以各种其他形式存在，例如XML文档、报告定义、数据库中的列描述、日志文件、连接和配置文件。
    
4.  **层级数据**：存储其他数据之间关系的数据。它可以作为财务系统的一部分存储，也可以作为对现实世界关系的描述单独存储，例如组织结构或产品BOM。层级数据有时被视为超级主数据域，因为它对于理解和发现主数据之间的关系至关重要。
    
5.  **参考数据：**一种特殊类型的主数据，用于对其他数据进行分类或用于将数据与企业范围以外的信息相关联。可以在主数据或交易数据对象之间共享参考数据，例如国家/地区、货币、时区、付款条件等。
    
6.  **主数据：**企业内部的核心数据，描述开展业务所围绕的对象。它通常不经常更改，并且可以包含经营业务所需的参考数据。主数据本质上不是事务性的，但它确实描述了事务。
    

**2 确定要管理的主数据**

**将哪些数据作为主数据进行管理？建议使用以下规则判断，在决定是否将给定实体视为主数据时综合考虑以下所有这些要素。**  

**行为数据**

主数据可以通过与其他数据交互的方式进行描述。例如：在交易系统中，主数据几乎总是与交易数据有关。从根本上讲，主数据和交易数据之间的这种关系可以看作是名词/动词关系。交易数据代表动词，例如销售、交付、购买、电子邮件和吊销，而主数据是其名词。

**生命周期**

主数据可以通过创建、读取、更新、删除和搜索的方式来描述。对于各种主数据元素类型而言每个公司都是不同的。

例如：如何创建客户很大程度上取决于公司的业务规则、行业细分和数据系统。一家公司可能有多个客户创建媒介，例如通过Internet，直接通过客户代表或通过直销店。另一家公司可能只允许通过与呼叫中心的电话直接联系来创建客户。此外，如何创建客户元素与创建供应商元素肯定不同。

下表说明了四个通用主数据域的不同CRUD周期。

<table><tbody><tr><td><p><span>生命周期</span></p></td><td><p><span>顾客</span></p></td><td><p><span>产品</span></p></td><td><p><span>资产</span></p></td><td><p><span>员工</span></p></td></tr><tr><td><p><span>创建</span></p></td><td><p><span>客户访问（例如访问电子采购网站）触发帐户创建</span></p></td><td><p><span>在供应链中购买或制造产品</span></p></td><td><p><span>在必要的批准流程下，通过采购订单获取</span></p></td><td><p><span>人力资源部聘用了一名新员工，然后他必须填写大量表格，参加入职培训，进行福利选择，确定资产分配并遵循办公室任务</span></p></td></tr><tr><td><p><span>读取</span></p></td><td><p><span>基于查看者凭据的上下文视图</span></p></td><td><p><span>定期库存目录</span></p></td><td><p><span>定期报告的目的，确定折旧，核实</span></p></td><td><p><span>办公室访问，绩效考核，保险索赔等</span></p></td></tr><tr><td><p><span>更新</span></p></td><td><p><span>地址，折扣，电话号码，信用帐户</span></p></td><td><p><span>包装变更，原材料变更</span></p></td><td><p><span>转移，维护，事故报告</span></p></td><td><p><span>移民状况，婚姻状况，专业提高，加薪，转岗</span></p></td></tr><tr><td><p><span>冻结</span></p></td><td><p><span>死亡，破产，清算</span></p></td><td><p><span>已取消，已更换，不再可用</span></p></td><td><p><span>已出售，已破坏，被盗，报废</span></p></td><td><p><span>合同终止，死亡</span></p></td></tr><tr><td><p><span>搜索</span></p></td><td><p><span>CRM系统，呼叫中心系统</span></p></td><td><p><span>ERP系统，订单处理系统</span></p></td><td><p><span>总帐跟踪，资产数据库管理</span></p></td><td><p><span>HR LOB系统</span></p></td></tr></tbody></table>

**数据基数**

随着数据基数减少，被视为主数据的可能性也随之降低。

例如：如果一家公司只有三个客户，那么组织很可能不会考虑这些客户的主数据。相反，有成千上万个客户的公司会认为客户是一个重要的主题领域，因为伴随着管理如此庞大的实体集所带来的问题和收益。

这两家公司的客户价值是相同的，因为两家公司都依靠他们的客户开展业务。但是，一个不需要客户主数据解决方案，而另一个则需要。基数不会改变给定实体类型的分类；但是，随着实体类型基数的增加，拥有用于管理实体类型的解决方案的重要性也随之提高。

**使用期限**

与交易数据相比，主数据的波动性较小。随着它变得更加不稳定，通常认为它更具事务性。

例如：有些情况可能会考虑减少主数据属性。有时可能会认为这是一笔交易。根据合同的期限，合同可以选择两种方式。

促进职业运动员发展的机构可以考虑其合同主数据。在这种情况下，每个彼此都不相同，并且通常具有超过一年的期限。仅拥有一个称为“运动员”的主数据项可能会很诱人。但是，运动员在任何给定时间往往都有多个合同：一个是与团队合作，另一个是与公司代言产品。随着每份合同的组成部分的重新谈判或运动员的交易，该机构将需要随着时间的推移管理所有这些合同。

**复杂程度**

简单实体即使是有价值的实体，也很少会面临管理上的挑战，很少被视为主数据。元素越不复杂，管理该元素的变更的可能性就越小。通常，仅对这些数据进行收集和统计。

例如：诺克斯堡可能不会跟踪其存储的每个金条的信息，而只会保留其中的数量。每个金条的价值都很高、基数高、寿命长、但是复杂度低。

**价值变化**

数据对公司而言越有价值，就越有可能将其视为主数据。

**重复使用**

重用是主数据管理的主要驱动力之一。

例如：在简单的企业中，CRM系统将管理有关客户的所有信息，而无需与其他系统共享有关客户的任何信息。但是，在当今复杂的环境中，客户信息需要在多个应用程序之间共享。

由于多种原因，并非总是可以访问主数据，因此人们开始将主数据存储在各个位置，例如电子表格和应用程序私有存储。仍然存在诸如数据质量下降之类的原因来管理未在整个企业范围内重复使用的主数据。但是，如果主数据实体可在多个系统中重用，则可以肯定的是，应作为主数据对其进行管理。

**3 总结**

尽管枚举各种主数据实体类型很简单，但是有时确定公司中的哪些数据项应被视为主数据更具挑战性。**通常，可能需要管理不符合主数据定义的数据。**

**最终，在决定应将哪些实体类型视为主数据时，与依赖于简单的实体类型相比，最好根据业务需求环境下的行为和属性对它们进行分类。**


### 为什么管理主数据？

**主数据由多个应用程序使用，所以一个地方的数据错误可能会在使用它的所有应用程序中引起错误。**

例如：客户主数据中不正确的地址可能意味着订单、账单和营销资料都被发送到了错误的地址，同样，错误价格可能会造成营销灾难。

**1 为什么需要管理主数据？**

一个典型的主数据恐怖故事：

信用卡客户从北第9街2847号移到北第11街1001号。客户立即更改了帐单地址，但几个月未收到帐单。一天，客户从信用卡帐单部门接到质询电话，询问为什么未还款。客户确认他们更改了新地址，而开票部门确认文件中的地址是北第11街1001号。客户要求账单的副本以结清帐户。

再过两周没有帐单后，客户回电，发现该帐户已移交给收款公司。这一次，客户发现，即使文件中的地址是1001号北第11街，帐单地址被列为101 11第北。在律师之间打了几次电话和来信之后，账单终于得到解决，信用卡公司失去了一个终身客户。

在这种情况下，数据的主副本是准确的，但是它的另一个副本是有缺陷的。**主数据必须正确且一致。即使主数据没有错误，也很少有组织只有一组主数据。**许多公司都是通过并购来发展的，上级组织收购的每个公司都有其自己的客户主数据、项目主数据等。

如果您可以将新的主数据与当前的主数据进行合并，这是最好不过的，但是除非被收购的公司在遥远的国家拥有完全不同的业务，否则很可能会有一些客户和产品出现在这两个国家中多组主数据且通常具有不同的格式和不同的数据库。

在大多数情况下，客户编号和产品编号是由创建主记录的软件分配的，因此在两个数据库中同一客户或同一产品具有相同标识符的机会非常小。如果从不同供应商编号的不同供应商那里购买了相同的产品，则物料主数据更难以统一和管理。

总之，由于同一客户在不同数据库中可能具有不同的姓名、客户编号、地址和电话号码，因此将主列表合并在一起可能非常困难。

**2 创建主数据的好处**

统一的合并账单，可以节省资金并提高客户满意度，无需担心从多个客户列表中向客户发送相同的营销文献，这既浪费钱又降低了客户体验，整个组织中客户的统一视图，即在将客户帐户移交给收款公司之前知道该客户是否欠组织的其他企业款，或者更重要的是，该客户是否是另一个部门的最大业务来源。统一的物料视图，以消除资金和货架空间的浪费，以及因在不同零件号下存储相同物料而造成的人为短缺的风险。

最后，**向SOA和SaaS的发展使主数据管理成为一个关键问题**。例如：如果创建通过定义良好的XML消息进行通信的单个客户服务，则可能会认为您已定义了单个客户视图。但是，如果将同一个客户存储在具有三个不同地址和四个不同电话号码的五个数据库中，那么您的客户服务将返回什么？同样，如果您决定订购通过SaaS提供的CRM服务，则服务提供商将需要数据库的客户列表。您将发送哪个列表？

由于所有这些原因，**为组织维护高质量、一致的主数据集正迅速成为一种必要。维护此数据所需的系统和过程称为“主数据管理”**。

**3 主数据管理什么？**

**主数据管理是确保主数据在整个企业范围内得到协调的技术、工具和流程。主数据管理提供了统一的主数据服务，该服务可为整个企业以及业务合作伙伴提供准确、一致和完整的主数据。**

此定义中有两点值得注意：

**主数据管理不仅仅是一个技术问题。**在许多情况下，需要对业务流程进行根本性更改以维护干净的主数据，并且**某些最困难的主数据管理问题比技术问题更难以协调。**

**主数据管理包括创建和维护主数据。**主数据解决方案必须包含工具和流程，以随着时间的推移更新和扩展主数据以保持整洁和一致，否则花费大量时间、费用和精力来创建一组干净、一致的主数据是一种浪费。

**主数据管理不仅仅是一个技术问题，这意味着企业不能仅靠安装一个系统就可以解决所有问题，那么强大的主数据管理应该包含什么呢？**

在开始进行主数据管理之前，主数据管理策略应围绕以下六个领域构建：

+   **治理：**管理组织机构、政策、原则和质量以促进对准确的和经过认证的主数据的访问。本质上，这是跨组织定义主数据管理程序各个方面的过程。
    
+   **评估：**根据既定目标做到何种程度？测量应着眼于数据质量和持续改进。
    
+   **组织：**在整个主数据管理中安排合适的人员，包括主数据所有者、数据管理员和参与治理的人员。
    
+   **制度：** 主数据管理应遵循的要求、政策和标准。
    
+   **流程：**整个数据生命周期中用于管理主数据的已定义流程。
    
+   **技术：**主数据系统、集成和所有相关支持技术。
    

**4 主数据怎么管？**

**专家提示：从关键数据源入手开展组数据治理工作更容易成功。**

如果您从小做起，则应该对所有最终可能要包含在企业中的主数据进行分析，以便以后被迫从头开始进行数据合并的重新设计。例如，如果您最初的客户数据仅包括直销团队的10000个客户，则您不希望做出设计决定来阻止以后再增加10,000,000个Web客户。

**所有的主数据管理项目都将受到需求、优先级、资源可用性、时间范围和问题规模的影响。**大多数主数据管理项目至少包括以下阶段：

**（1）识别主数据来源**

此步骤通常是通过启发性的会议实现。一些公司发现他们有数十个IT部门都不知道的客户数据的数据库。

**（2）识别主数据的生产者和消费者**

此步骤涉及查明哪些应用程序生成第一步中确定的主数据，以及哪些应用程序使用主数据。根据用于维护主数据的方法，此步骤可能不是必需的。例如，如果在数据库级别检测到并处理了所有更改，则更改来自何处可能无关紧要。

**（3）收集和分析主数据的元数据**

对于第一步中确定的所有来源，数据的实体和属性是什么，它们的含义是什么？其中应包括：

+   属性名称
    
+   数据类型
    
+   允许值
    
+   约束条件
    
+   默认值
    
+   依存关系
    
+   谁进行数据的定义和维护
    

 **“所有者”是最重要的，通常也是最难确定的。**如果您的存储库中加载了所有元数据，那么此步骤很简单。如果必须从数据库表和源代码开始，这可能是一项巨大的工作。

**（4）任命数据管理员**

这些人应该是了解当前源数据并且能够确定如何将源数据转换为主数据格式的人员。通常，数据管理员应由每个主数据源的所有者，负责主数据管理的架构师以及主数据业务用户担任。

**（5）实施数据治理计划和数据治理委员会**

该小组必须具有权限来决定如何维护主数据，其内容、保留多长时间以及如何授权和管理变更。在主数据项目过程中必须做出数百个决策，**如果没有明确定义的决策机构和流程，则该项目可能会失败，因为组织壁垒会阻止有效的决策**。

**（6）开发主数据模型**

确定主数据的模型，包括主数据的属性、大小和数据类型、允许的值等等。此步骤还应包括主数据模型和当前数据源之间的映射。这通常是该过程中最重要和最困难的步骤。如果您试图通过将所有源属性都包含在主数据实体中来使所有人满意，那么您最终往往会获得过于复杂和繁琐而无法使用的主数据。

例如：如果您不能决定重量应该以磅还是千克为单位，则一种方法是将两者都包括在内。虽然这可能会让人们感到高兴，但您却浪费了数兆的存储空间，因为这些数字可以以微秒为单位进行计算，并且存在创建不一致的数据的风险（WeightLb = 5，WeightKg = 5）。尽管这是一个非常简单的示例，但更大的问题是要为同一零件保留多个零件号。

就像委员会所做的任何努力一样，冲突和业务阻碍会导致决策不佳。**提前制定决策流程，优先级和最终决策者，以确保事情顺利进行，这一点很重要。**

**（7）选择合适的工具集**

您将需要购买或构建工具以通过清理、转换和合并源数据来创建主数据代码库。您还将需要一个基础结构来使用和维护主数据代码。这些功能将在本文后面详细介绍。您可以使用来自单个供应商的单个工具集来实现所有这些功能，或者您可能希望采用同类最佳的方法。通常，对于不同类型的数据，清除和合并数据的技术是不同的，因此没有很多工具可以覆盖整个主数据范围。**该工具集还应该支持查找和修复数据质量问题以及维护版本和层次结构。版本控制是一项关键功能，因为了解主数据记录的历史对于随着时间的推移保持其质量和准确性至关重要。**

例如：如果合并工具合并了波士顿的约翰·史密斯的两个记录，而您确定波士顿确实有两个不同的约翰·史密斯，则需要在合并之前知道这些记录的样子，以便“取消合并”。

放眼大局，**主数据管理系统的功能应包括数据建模、数据集成、数据匹配、数据质量、数据管理、层级管理、工作流和数据治理。**从非功能性的角度来看，您还应该考虑可扩展性，可用性和性能。

**（8）设计集成架构**

一旦获得了干净、一致的主数据，您将需要将其公开给您的应用程序，并提供流程来管理和维护它。实施此集成架构后，您将拥有大量依赖于集成架构的应用程序，因此，可靠性和可伸缩性是设计中要考虑的重要考虑因素。在大多数情况下，企业必须自己制定集成架构的重要部分，因为它将被设计为适合企业当前应用的数据集成、平台和应用程序。

**（9）生成并测试主数据**

在此步骤中，使用主数据管理工具将源数据合并到主数据列表中。这通常是一个迭代过程，需要设置和修改规则才能获得正确的匹配。这个过程还需要大量的人工检查，以确保结果正确并满足项目要求。

**没有工具会100％地正确完成匹配，因此您必须权衡错误匹配和错过匹配的后果，以确定如何配置匹配工具。**如果账单不正确或逮捕了错误的人，则错误的匹配会导致客户不满意。错过的匹配太多，会使主数据的使用率降低，因为您没有获得在主数据管理上投入的收益。

**（10）修改生产和消费系统**

根据主数据管理实施方案的方式，可能必须更改产生、维护或使用主数据的系统，以使用新的主数据源。如果主数据用于与源系统不同的系统中（例如，数据仓库），则源系统可能不必更改。

但是，如果源系统要使用主数据，则可能需要进行更改。源系统将必须访问新的主数据，或者主数据将必须与源系统同步，以便源系统具有清理后的主数据的副本以供使用。如果不可能更改一个或多个源系统，则该源系统可能无法使用主数据，或者必须通过触发器和SQL等外部过程将主数据与源系统的数据库集成在一起。

在创建新记录或更新现有记录之前，应更改生成新记录的源系统。这样可以确保上游生成的数据质量良好，以便主数据管理可以更有效地运行，并且应用程序本身可以管理数据质量。主数据管理不仅应被用作记录系统，而且应被 用作促进企业中所有应用程序中的数据更干净、更有效地处理的应用程序。

作为主数据管理策略的一部分，需要研究数据管理的三个主要方面：数据来源、数据管理、数据消费。如果忽略这些方面中的任何一个，就不可能拥有可靠的企业级主数据管理。

**（11）实施维护流程**

**任何主数据管理实施都必须包含工具、流程和人员，以保持数据质量。**所有数据都必须有一个数据管理员，负责确保主数据的质量。

**数据管理员通常是具有数据知识，可以识别不正确的数据并且具有纠正问题的知识和权限的业务人员。**主数据管理应包括可帮助数据管理员识别问题并简化更正的工具。一个好的数据管理工具应该可以提示可疑匹配，例如，居住在同一地址的具有不同名称和客户编号的客户。

**管理员可能还希望查看由于匹配条件相近但低于阈值而添加为新项的项目。对于数据管理员而言**，查看主数据管理软件对数据所做的更改的历史很重要，以便隔离错误源并撤消不正确的更改。维护还包括将更改和添加到主数据管理系统中以及将清理后的数据分发到所需位置的过程。

本文的其余部分将介绍用于创建和维护主数据的技术和过程的详细信息。

1

如何创建主数据代码库

无论是购买主数据管理工具还是决定构建自己的主数据管理工具，都有两个基本步骤来创建主数据：

+   **清洗和标准化数据；**
    
+   **匹配所有来源的数据以合并重复项。**
    

**（1）清理和标准化主数据**

在开始清理和规范化数据之前，必须了解主数据的数据模型。在建模过程中，您应该定义每个属性的内容，并定义从每个源系统到主数据模型的映射。现在，您可以使用此信息来定义清理源数据所需的转换。

清理数据并将其转换为主数据模型与数据仓库的提取、转换和加载（ETL）过程非常相似。以下是一些典型的数据清洗功能：

+   标准化数据格式：使所有电话号码看起来相同，将地址转换为通用格式。
    
+   替换缺少的值：插入默认值，从地址中查找邮政编码。
    
+   标准化值：将所有度量转换为公制，将价格转换为通用货币，将零件编号更改为行业标准。
    
+   映射属性：从联系人姓名字段中解析名字和姓氏，将Part＃和partno移至PartNumber字段。
    

大多数工具会清洗可能被清理的数据，并将其余的数据放入错误表中以进行手工处理。根据匹配工具的工作方式，清理后的数据将被放入主数据代码中。在清理每个源时，应检查输出以确保清理过程正常进行。

**（2）匹配数据以消除重复**

**匹配主数据记录以消除重复是创建主数据中最困难也是最重要的步骤。**错误的匹配实际上可能会丢失数据（例如，两个Acme Corporation成为一家），而丢失的匹配会降低维护公共代码库的价值。

因此，**主数据管理工具的匹配精度是最重要的标准之一。**

有些匹配常简单。如果您对所有客户都有社会保险号，或者所有产品都使用通用编号方案，则数据库JOIN将找到大多数匹配项。但是，在现实世界中几乎不会发生这种情况，因此匹配算法通常非常复杂。客户可以在名称、姓氏、昵称、地址、电话号码等上进行匹配，而产品在名称、描述、零件号、规格和价格上进行匹配。

**专业提示：匹配项越多，匹配项越接近，主数据管理软件对匹配项的可用就越高。**

将为每个匹配项计算置信度，如果超过阈值，则记录匹配。通常根据错误匹配的结果来调整阈值。

例如：我们可以指定，如果置信度超过95％，则记录将自动合并；如果置信度在80％至95％之间，则数据管理员应在合并之前批准匹配。

**（3）您应该如何合并数据**

大多数合并工具会将一组输入合并到主列表中，因此最好的过程是使用质量最号的数据开始，然后再依次合并其他源。如果您有很多数据，并且有很多质量问题，则此过程可能需要很长时间。

您可以在时间和资源允许的情况下逐步添加其他任务。这种方法意味着您的项目将花费更长的时间，甚至可能花费更多，但是风险更低。这种方法还允许您从几个组织开始，并在项目证明成功时添加更多组织，而不是尝试从一开始就让所有人参与进来。

将源数据合并到主列表时要考虑的另一个因素是隐私。当客户成为客户主体的一部分时，任何有权访问客户主体的应用程序都可以看到他们的信息。如果客户数据是根据将其使用限制在特定应用程序中的隐私策略获得的，则您可能无法将其合并到客户主数据中。

此时，如果您的目标是生成主数据代码库，那么您就完成了。打印出来或将其刻录到外部硬盘驱动器上并继续前进。如果您希望您的主数据在添加和更改数据时保持最新，那么您将不得不开发基础结构和流程来管理随时间变化的主数据。

2

如何维护主数据

有许多不同的工具和技术可用于管理和使用主数据。我们将在这里介绍三种较常见的方案：

**单一副本：**采用这种方法时，主数据只有一个主副本。所有添加和更改都直接对主数据进行。所有使用主数据的应用程序都将被重写以使用新数据，而不是其当前数据。这种方法可以保证主数据的一致性，但是在大多数情况下不切实际。那是因为修改所有应用程序以使用具有不同架构和不同数据的新数据源是非常昂贵的。对于某些应用程序，甚至不可能实现。

**多个副本，单个维护：**通过这种方法，可以在数据的单个主副本中添加或更改主数据，但是将更改发送到将副本本地存储在其中的源系统。每个应用程序都可以更新不属于主数据的数据部分，但是它们不能更改或添加主数据。

例如：库存系统可能能够更改零件的数量和位置，但是无法添加新零件，并且不能更改产品主数据中包含的属性。这减少了所需的应用程序更改次数，但是应用程序将最少必须禁用添加或更新主数据的功能。用户将必须通过主数据系统才能添加或修改主数据，而他们通常使用的业务系统添加主数据功能将不再起作用。

**连续合并：**在这种方法中，允许应用程序更改其主数据副本。对源数据所做的更改将发送到主数据库，然后在此处合并到主数据库列表中。然后，对原版的更改将发送到源系统，并应用于本地副本。这种方法几乎不需要更改源系统。如有必要，可以在数据库中处理更改，因此无需更改应用程序代码。表面上看，这似乎是理想的解决方案，因为可以将应用程序更改减到最少，并且不需要重新培训。每个人都在做自己在做的事情，且质量更高，数据更完整。但是，此方法确实存在几个问题：

**更新冲突是可能的并且难以调和**：如果两个源系统将客户的地址更改为不同的值会发生什么？主数据管理软件无法决定保留哪一个，因此需要数据管理员的干预。同时，客户有两个不同的地址，必须通过创建数据管理规则和标准操作程序来解决此问题，以确保减少或消除更新冲突。

**必须重新合并添加项**：添加客户时，可能有另一个系统已经添加了该客户。为了应对这种情况，所有添加的数据都必须再次经过匹配过程，以防止母版中出现新的重复项。

**保持一致的值更加困难**：如果将产品的重量从磅转换为公斤，然后再转换为磅，则四舍五入会改变原始重量。这可能会使输入值几秒钟后就看到值变化的用户感到不安。

通常，所有这些事情都可以进行计划和处理，从而使用户的使用变得更轻松一些，但需要维护更复杂的维护组织并需要更多数据管理员的工作。这可能是一个可以接受的折衷方案，但这是应该有目的地做出的选择。

**（1）关于版本和审核的几点思考**

**无论您如何管理主数据，理解数据如何达到当前状态都非常重要。**

例如：如果客户记录是从两个不同的合并记录合并而成的，则在数据管理员确定记录被错误合并的情况下，您可能需要知道原始记录的样子，并且实际上应该是两个不同的客户。版本管理应包括用于显示版本并将更改的全部或部分还原到以前的版本。

管理系统使用的版本的正常分支和更改分组对于维护不同的派生更改并将更改组还原到先前的分支也非常有用。数据管理和合规性要求通常会包含一种确定每个更改的人和更改时间的方法。

为了支持这些要求，**主数据管理软件应包括用于审核主数据更改的功能**。除了保留审核日志外，主数据管理软件还应该包括一种简单的方法来查找您要查找的特定更改。主数据管理系统每天可能审核数千个更改，因此**审核日志的搜索和报告功能很重要。**

**（2）关于层级管理的几点思考**

**除了主数据本身之外，主数据管理软件还必须维护数据层次结构。**例如，产品物料清单、销售区域结构、客户的组织结构等。对于主数据管理软件来说，管理这些层次结构很重要，但是对于主数据管理软件来说，能够独立于底层系统修改层次结构也很有用。

例如：当员工转移到其他成本中心时，可能会对差旅和费用系统、薪资、报告结构和绩效管理产生影响。如果主数据管理软件管理层次结构，则对层次结构的更改可以在单个位置中传播到所有下游系统。

例如：可能需要将收入和支出汇总到任何单一源系统中都不存在的组织结构中。规划和预测还可能需要临时层次结构才能为建议的组织变更计算“预测”数字。在许多情况下，还需要历史层次结构才能将财务信息汇总到过去存在的结构中，而不是当前的结构。

**由于这些原因，强大而灵活的层次结构管理功能是主数据管理软件的重要组成部分。**

**5 谁需要参与主数据建设？**

实际上，有几种不同的方式来考虑谁参与主数据管理。首先，让我们从高层次看一下三个核心角色：

+   **数据治理用户：**推动定义、需求和解决方案的个人。这些用户可帮助管理员了解要创建的内容，并帮助数据管理员了解要管理的内容以及如何对其进行管理。数据治理用户指导数据管理者应如何管理数据（包括管理过程），然后使数据管理者对遵循这些要求负责。数据治理用户还向管理员提出在主数据管理解决方案实施期间要创建的内容，尤其是从数据匹配和质量角度而言。数据治理用户还需要维护主数据管理的反馈闭环管理，以确保一切正常进行。此反馈涵盖了主数据管理程序的测量角度，并且可能包含以下信息：需要花费多长时间？过程变的更快还是变慢？数据匹配的效果如何？从数据质量的角度来看，有多少个业务规则失败了？
    
+   **技术管理者：**负责设置和配置解决方案的IT人员。
    
+   **数据管理者：**由业务人员引导，负责修复，清理和管理数据。理想情况下，数据管理者来自整个业务部门，例如财务和营销部门。通常，数据管理者在数据管理用户中定义数据管理员执行的活动。
    

其他主数据管理角色可以包括组织/项目类型，并且随组织/项目类型的不同而变化：

<table><tbody><tr><td><p><span>角色</span></p></td><td><p><span>技能/职责</span></p></td><td><p><span>参与程度</span></p></td></tr><tr><td><p><span>项目经理</span></p></td><td><p><span>负责数据管理策略和主数据平台实施</span></p></td><td><p><span>专职</span></p></td></tr><tr><td><p><span>项目助理</span></p></td><td><p><span>制定和管理项目计划，确保及时交付高质量的成果并报告项目进度。负责风险和问题的管理与升级。</span></p></td><td><p><span>按需</span></p></td></tr><tr><td><p><span>系统管理员和DBA</span></p></td><td><p><span>系统管理员：系统管理员倾向于从事管理域，存储，虚拟化，组策略，DNS，某些网络等内容的工作。</span></p><p><span>DBA：结合了系统管理的一些技能，开发领域的一些技能以及所使用的数据库平台的专门知识。</span></p></td><td><p><span>按需</span></p></td></tr><tr><td><p><span>开发者</span></p></td><td><p><span>开发人员实施定制的SDK和/或工作流解决方案来扩展主数据管理平台。这可能包括基于Web服务的集成，定制的用户界面或利用API或主数据管理数据的自定义应用程序或过程。</span></p></td><td><p><span>按需</span></p></td></tr><tr><td><p><span>ETL开发人员</span></p></td><td><p><span>这些团队成员从源系统中加载批数据（ETL集成）</span></p></td><td><p><span>按需</span></p></td></tr><tr><td><p><span>业务分析师</span></p></td><td><p><span>熟悉与主数据管理解决方案相关的数据和业务流程的资源。提供对应用程序功能和要求的深入了解，并参加研讨会，计划和执行审阅和测试活动。</span></p></td><td><p><span>按需</span></p></td></tr><tr><td><p><span>数据架构师/数据建模师</span></p></td><td><p><span>监督符合组织标准和约定的企业概念，逻辑和物理数据模型；提供企业数据策略的领导和指导，尤其是与主数据管理相关的策略；协助组织治理实践和标准，并充当业务与IT之间的联络人，以澄清数据要求。</span></p></td><td><p><span>按需</span></p></td></tr><tr><td><p><span>最终用户/数据管理员</span></p></td><td><p><span>与主数据和业务流程进行交互的个人。这些是主数据管理系统的业务用户，并充当数据的管理者或维护者。</span></p></td><td><p><span>全职</span></p></td></tr><tr><td><p><span>治理委员会</span></p></td><td><p><span>主数据治理委员会（MDGC）是与数据相关的事务的决策和决策机构。MDGC监督数据标准和质量保证的实施，以确保主数据管理团队和数据管理员正在开发、维护并提供可接受的系统数据以供其他人使用。</span></p></td><td><p><span>按需</span></p><p><span>（定期会议）</span></p></td></tr></tbody></table>

1

主数据管理利益相关者

**除了执行和管理主数据管理策略的角色之外，成功的主数据管理项目的关键之一就是关键利益相关者的积极投入。**典型的主数据管理参与的利益相关者包括代表业务和IT的利益相关者。积极的利益相关者通常包括但不限于以下类型的角色：

+   业务或IT项目发起者
    
+   IT项目负责人
    
+   受影响业务领域专家
    
+   数据管理员
    
+   IT交付团队
    

由于在整个组织中定义了主数据管理利益相关者，因此确保他们的参与并致力于组织的主数据管理过程至关重要。通过多年实施经验，确定了几个“健康”指标来帮助确定主数据管理利益相关者的影响：

<table><tbody><tr><td><p><span>健康特征</span></p></td><td><p><span>不健康特征</span></p></td></tr><tr><td><p><span>行政激励与项目成果挂钩</span></p><p><span>投资于变更管理和培训</span></p><p><span>专职领域专家全职参与</span></p><p><span>业务部门有适当的参与和支持</span></p><p><span>定期举行指导委员会会议，及时采取决定和采取行动，并且有效</span></p><p><span>所有适当的利益相关者团体均得到有效代表和参与</span></p></td><td><p><span>没有可见的执行发起人</span></p><p><span>抵抗新思想、新变更</span></p><p><span>没有可用的“专家”</span></p></td></tr></tbody></table>

2

主数据管理指导委员会

**建议主数据管理利益相关者的管理层代表组成一个指导委员会，以促进跨职能决策。**以下是有效的指导委员会的一些特点：

+   **范围适当**\-足够大以代表优先级利益相关者，但又足够小以快速分析关键信息并制定决策；
    
+   **专注于快速决策；**
    
+   **成为消除组织障碍的手段，而不仅仅是例行会议来聆听项目团队成员的报告。**
    

一旦确定了利益相关者，主数据管理项目章程应包括成立指导委员会。在运行数百个或主数据管理项目的基础上，建议以下角色参加指导委员会。请注意，每个角色可能有一个以上的团队成员，或者某些角色可能不适用或公司的组织结构。

采取的措施通常为标记无效或标记删除，而不是直接物理删除。只有定期对数据进行归档时，才会考虑将主数据从系统中彻底清除。

## DDP
**前言**

数字化和数据平台（Digital and Data Platform，缩写为DDP），是BCG基于全球领先的数字化转型实践，总结出来的企业数字化技术架构参考模型。企业数字化转型在信息技术应用上具有这样的特点：- 面向企业内外的用户，以用户体验为中心，不断创新数字化产品；- 整合企业内外部数据，用数据分析形成业务洞察；- 大量的业务流程实现了智能化、自动化；- 业务能力表现为模块化、可被调用的服务，在企业内外被快速整合，支持平台型组织和平台商业模式的转型；- 在数字环境下对核心系统进行升级换代。

在架构管理、业务流程设计、变革管理、IT交付模式等方面，建立完善的项目规划和实施体系

**一**

**数字化转型的技术架构要求**

当今大多数企业信息技术架构的敏捷化程度不够，不能满足数字化转型的要求：传统竖井式建设的信息系统修改困难、集成混乱；数据被割裂深锁在各个系统内，不能被自由利用；企业缺乏自有的技术开发能力，无法快速响应业务需求。因此，企业迫切需要建设下一代信息技术架构。

![](http://dgiot-1253666439.cos.ap-shanghai-fsi.myqcloud.com/shuwa_tech/zh/blog/knowledge/ddp/1.jpg)

DDP就是因这样的趋势，被BCG的架构专家们提出来的。它的主要特点是：

**1、模块化**

对企业业务应用系统传统的“巨石式”单体架构进行解耦，形成可以独立创建、修改、互换、互连的更小的业务应用模块，每个业务应用模块代表一项业务能力，称为“微服务”。

**2、平台化**

业务应用模块之间进行连接的方式称为应用程序接口（API），API不仅用于连接企业内部的业务能力，还可以将业务能力打包开放给企业外部，使企业业务平台化。

**3、分层级**

为了形成整合的用户界面、业务能力及服务、应用系统以及数据视图，将数据从传统系统中解放出来，DDP横向整合，分为基础设施层、核心业务系统层、数据层、数字化应用层。

**4、新技术能力**

DDP具备新一代的技术能力，包括软件开发和测试相结合，使开发人员可以面向生产环境持续集成和部署，建立提高软件应用发布效率的DevOps体系。此外，新一代架构暴露在互联网环境下，必须提升系统和数据的网络安全防护。

**5、需要组织变革支持**

实施DDP需要推进一系列运营模式和技术管理的组织变革。业务运营上要提升平台管理和服务治理的能力，全面融合业务和IT组织。IT组织内，要发展工程能力，重塑人员技能，还要改变传统的IT供应商外包及合作模式。

![](http://dgiot-1253666439.cos.ap-shanghai-fsi.myqcloud.com/shuwa_tech/zh/blog/knowledge/ddp/2.jpg)

**二**

**什么是DDP？**

DDP模型共包含六层，分别是数字化应用层 、数据与分析层、业务核心系统层 、云基础设施层、集成与API层、网络安全层。

![](http://dgiot-1253666439.cos.ap-shanghai-fsi.myqcloud.com/shuwa_tech/zh/blog/knowledge/ddp/3.jpg)

**1、数字化应用层**

这一层是面向用户使用的数字化界面，并且支持用户交互提供服务。它的职责首先是实现全渠道接入以及用户的全旅程无缝体验，例如统一身份认证，统一流程编排等；其次是基于微服务框架，提供细粒度的服务组件，例如在电商应用环境下的用户管理、订单管理、商品管理等组件；再者提供数字化通用技术组件， 来支持业务组件运作，例如处理身份的人脸识别、文字转化的语音识别、支持智能交互的自然语言处理、支持智能决策的知识图谱等。

**2、数据与分析层**

这一层也称作大数据平台或者数据分析平台，面向业务应用提供数据服务，主要职责有：1）对来自不同渠道（例如数字化营销的私域和公域以及后端核心业务系统等）的各种数据，包括结构化和非结构化数据，做统一接入与整合、存储与处理；2）建立数据治理机制，保证数据应用的质量；3）分析与服务，借助各类分析模型、算法和机器学习能力从数据中提炼洞察，基于这些洞察提供智能服务，例如个性化推荐、精准营销、定价决策、风险预警等。这些服务以API方式被其他应用接入。

**3、业务核心系统层**

这一层和上述持续变化、敏捷的数字化应用层相对应。我们将支持企业内较为稳定、不常变化、处理内部管控信息记录及业务流程的信息系统称为“稳态系统”，没有必要或者短期内难以解耦为微服务化，这类系统归属于核心业务系统层，亦即从传统企业信息化时代继承过来的“遗留系统”。上述两层从概念上接近国内流行说的“业务中台”和“数据中台”，那么本层可以认为是“业务后台 ”，比如大家熟悉的企业级解决方案——ERP系统、HR系统、CRM系统，以及各类业务执行系统（例如生产企业的MES系统、银行证券的核心交易系统、保险行业的保单和理赔系统等）。

![](http://dgiot-1253666439.cos.ap-shanghai-fsi.myqcloud.com/shuwa_tech/zh/blog/knowledge/ddp/4.png)

**4、云基础设施层**

基础设施是支持企业信息系统运行的各类计算、存储和网络资源。传统基础设施的形式是物理的机房或数据中心，目前的主流形式则是由云供应商以云服务的方式提供。企业上云最简单的形式是应用系统运行在云上的虚拟机，而更纯粹的上云方式则是应用系统的开发和管理都采用云平台。云提升了企业在基础设施上支出的弹性，企业应用系统部署可以在私有云、混合云和公有云等多种模式中选择。

**5、集成与API层**

企业的各个服务、系统和层级之间需要实现互联互通，集成技术和API起到粘合剂的作用。对内实现各个层级以及每层内各个组件间的信息流集成；对外实现和各个生态合作伙伴间的系统信息流集成。集成形式上，包括传统的消息集成（MQ）和企业服务集成（ESB），以及数字化时代主流的API集成。

**6、网络安全层**

数字化时代，安全风险已经渗透在上述各个层面，例如身份认证、访问控制、应用安全、数据安全、主机安全、网络安全和物理安全等，在各个层级上都需要建立完善的安全机制。

**三**

**核心系统的现代化**

传统的企业信息化进程中，形成了若干支持内部业务流程、记录管控及合规相关信息的核心业务系统，其中最有代表性的是广为人知、实现跨职能集成的ERP系统。由于技术架构的限制，这类核心系统在业务操作中存在大量手工处理、用户操作界面不友好、交易操作和数据分析分离而无法实现实时分析和决策支持、二次开发成本高、集成困难等问题。

企业实施DDP架构可以改变传统核心系统的这些不足，切实推动从以流程管控为核心的信息化转向以用户体验为核心的数字化。传统核心系统向下一代架构转化的要点是“换核、解耦、上云”。 

**要点一：换核**

传统核心系统的技术正在更新换代，例如市场上最主流的ERP系统SAP推出了采用新一代数据库和开发技术的版本—S/4 HANA，不少使用旧版本SAP ERP的企业正在向S/4 HANA升级，从而构建新一代数字化内核；稳态性质的业务建议保留在核心系统内，形成精简的核心。

**要点二：解耦**

对于支持用户前端持续变化的业务，或者跨系统共用的业务能力，需要从核心系统中以模块化的方式分离出来，这个过程称为“解耦”，使企业应用架构形成“简内核、松耦合”的形态。

**要点三：上云**

企业应用系统的开发环境、开发工具和运行时环境从ERP系统内转移到云平台上，通过整合的调度中心来访问所有服务，在平台上实现应用集成、数据分析以及AI扩展。

下图是BCG Platinion基于DPP模型，规划并实施“下一代ERP”的方法：

![](http://dgiot-1253666439.cos.ap-shanghai-fsi.myqcloud.com/shuwa_tech/zh/blog/knowledge/ddp/5.png)

**四**

**数据民主化**

在传统企业信息技术应用中，由于技术和架构的限制，数据都被锁定在各个信息孤岛里。在数字化转型的环境里，数据从遗留系统中解放出来，成为企业级资产，在企业内各个团队或部门可以根据需要，自主访问被授权的数据，彻底释放数据资产的商业价值。

DDP的数据层集成了企业所有内外部数据，并将使用权“民主化”。企业分割的数据源，无论是存在于内部核心系统、实时交易系统，还是外部数据源，例如社交媒体、气象数据等大数据，都可以通过自动化的方式被集中整合到“数据湖”里，面向实际业务应用或分析的场景，对数据进行预处理（如数据虚拟化、数据集市等），然后快速、简便、智能地生成需要的数据服务。数据层还可以接入业务事件中持续产生的流式数据，支持实时的业务响应。

![](http://dgiot-1253666439.cos.ap-shanghai-fsi.myqcloud.com/shuwa_tech/zh/blog/knowledge/ddp/6.jpg)

数据可得性和数据质量决定了数据应用的价值，有价值的数据是企业的资产。因此，企业需要建立良好的数据管理和数据治理体系。DDP的数据层还包括了主数据管理能力和数据治理工具。

**五**

**API管理**

API通过支持平台和生态系统业务模型以及敏捷的业务流程，在数字化转型和创新方面发挥着关键作用。微服务和API是组织构建平台和开发生态系统的两个技术基础。

随着DDP架构实施，组织内API的数量，不仅在IT部门增长非常迅速，在业务线内也不断蔓延，对公共和私有API以及API主导的连接性的需求日益增长，推动了组织对API管理方案的需求。

![](http://dgiot-1253666439.cos.ap-shanghai-fsi.myqcloud.com/shuwa_tech/zh/blog/knowledge/ddp/7.jpg)

DDP需要具有这样一些API管理能力：

![](http://dgiot-1253666439.cos.ap-shanghai-fsi.myqcloud.com/shuwa_tech/zh/blog/knowledge/ddp/8.jpg)

**1、API网关**

位于API前面的组件，是定义的后端API和微服务（包括内部和外部）的单一入口点。它充当保护器，加强安全性并确保可扩展性和高可用性。API网关接收所有API请求，确定需要哪些服务，并将它们组合成统一、无缝的用户体验。

**2、开发者门户**

是API及其应用相关方之间的桥梁，用于定位、推广和治理使用API的开发人员社区。它还提供了其他有用的特性，如运行时管理、API分析，并给出了API价值的估计。

**3、API生命周期**

成熟的工具可以支持软件和API的开发生命周期，通过促进团队协作和任务自动化，及时、高质量地交付。API生命周期的过程，可以与DevOps管道的各个阶段形成映射关系。

![](http://dgiot-1253666439.cos.ap-shanghai-fsi.myqcloud.com/shuwa_tech/zh/blog/knowledge/ddp/9.jpg)

**六**

**实施考量因素**

DDP是企业数字化转型在技术方面的抓手，实施DDP不仅是一个技术课题，更需要配套的组织、流程和人员技能变革。BCG在全球多个DDP规划和实施项目中，总结出了六大关键成功因素：

**因素一：数字化转型的治理机制**

数字化转型不只是IT部门的职责，业务人员和IT人员充分融合来创造数字化产品的敏捷方法，是实施DDP的基本工作方式，组织内大规模敏捷推进需要建立新的业务/IT治理模式。

**因素二：用释放数据价值的动力来启动架构转型**

今天，大多数企业的信息技术应用都不是白纸一张，实施DPP需要寻找立竿见影的切入点。我们发现将数据从遗留系统释放出来通常是企业最迫切的需求，数据层整合是DDP取得速赢的首选。

**因素三：业务场景驱动平台建设**

DDP服务于用户场景，企业需要根据用户旅程设计业务场景，例如数字化供应链、智能制造、实时智能推荐等，从业务场景对数字化平台的微服务能力提出要求。

**因素四：打破组织壁垒**

DDP需要建立平台和数字化产品的产品管理和运营体系，按照端到端的业务流程或者无缝重构用户旅程的要求，打破企业内的组织壁垒。

**因素五：培养人员新技能改变IT运作模式**

DDP更新了企业信息技术的技术栈，平台化对企业技术开发能力提出了更高的要求，DDP需要诸如企业架构师、技术和数据架构师、数据科学家、DevOps工程师、全栈工程师等技术角色。企业应通过重新培训，甚至招聘新人来获得这些能力。同时，实施DDP还需要企业全面评估套装软件的定制、IT外包模式、代码管理、开源化等策略。

**因素六：明确成功的衡量标准**

推进数字化转型需要采取小步快跑的敏捷方式，企业要建立起一套衡量标准来评估DDP架构转型的进度、成熟度，以及带来的业务价值，从而保证敏捷迭代的有效性。

为了帮助企业实现DDP架构转型，BCG建立了一支多学科团队，包括行业专家、数字化战略专家、架构专家、数据科学家、网络安全专家、敏捷教练等，帮助企业解决架构转型中各方面遇到的难题。


## 开源培训

### dgiot: 开源项目职业教育助力解决过度补课难题

国家：人口老龄化，鼓励天下父母生三胎，打击补课为教育减负，为父母减负，多家课外培训上市公司瞬间蒸发了几千亿市值。

父母：孩子不能输在起跑线上，倾尽全力去给孩子补课，大课被禁，私教来补，补课价格反而涨，教育负担反而重。

如果把补课作为供给侧，那么起跑线就是需求侧，单纯打击供给侧往往会带来相反的效应，例如我国打压房地产的政策，韩国历史上曾经立法打击课外培训，但却效果不佳。

那么何为起跑线呢？跑道是什么呢？终点又是什么？大三之前学生所学的课程大致都相同的，这部分知识是现代社会的基础知识，是未来职业发展的起跑线，孩子未来上升空间至关重要的因素，如果几代人输在起跑线上就会固化成社会阶层。

在工业社会，基础资源稀缺, 通过应试和择校制度让部分孩子进入职校，符合过去发展工业化的需求，但这在信息和智能时代已经过时。在今后相当长一段时间里，人工智能和机器人会取代很多高级技术工人的需求，高级技工需要升级成为智能工厂的管理者，就需要接受大学的教育，职业教育终身化需要现在大学本科的教学通识化，让学生学习掌握计算机、统计、人文、经济等基础知识。**实行基础教育资源均等化开始改革**，大学扩招、让每个孩子都能享受起跑线教育。通过改革来增加家长和学生的幸福度，并且减轻养育成本，振兴人口政策。

起跑线和终点问题是国家战略，相信未来国家会处理的更好，dgiot关注解决跑道问题--职业教育身化，希望能在战术层面为振兴人口政策加油助力。

要成为某个领域的专家，需要10000小时，这句话概括了职业教育的精髓。按比例计算就是：如果每天工作八个小时，一周工作五天，那么成为一个领域的专家，至少需要五年的时间。要在某个领域安身立命5年有两条途径：1、他人出资养活，2、自己赚钱养活。起跑线好，上升空间大，获得他人出资、自己赚钱去坚持10000小时的机会越大，成为领域专家的概率越大。

在软件领域，百分之七十以上的软件工程师具备本科以上学历，是和起跑线强相关的领域。美国人口是中国的四分之一，但美国软件工程师将470万万，中国软件工程师是160-180万。宏观来看，未来10年，软件工程师数量将从2000多万增长到4000多万，物联网应用工程师至少会带来200万以上的增量，在欧美/印度等软件强国多重挑战下，中国如何夺2000/200万软件领域专家更多增量，对抢夺物联网/大数据/人工智能战略高地制高点至关重要。微观来看，如何让更多的应届毕业生在软件领域安身立命，完成10000小时的蜕变在这场决战中至关重要。这个问题从本质上来说还是一个供给侧和需求侧的问题，从物联网领域来看，降低企业上物联网门槛(需求侧)，降低大学生进入物联网领域门槛（供给侧)，**dgiot倡导通过开源项目本地职业化教育解决方案**。

dgiot开源物联网项目通过物联网系统大部分共性化需求工具化，解决企业在物联网应用中百分之八十的需求，形成物联网领域的SDK和ADK（移动互联网成功关键之一），大大降低了企业上物联网的试错成本；通过开源项目本地化培训，让具有良好基础教育的应届大学生先跳过物联网百分之八十的共性需求研发，直奔企业最关心的百分之二十的定制化需求，帮助企业在物联网领域的商业成功模式添上最后一块拼图，形成供需两旺的局面。这样将会有更多的大学生可以在软件领域完成10000小时的修炼，成为软件领域专家。

dgiot开源物联网将面向应届大学生推广物联网应用工程师半月培训和数月的实战实习，同时也面向一线工程人员推广物联网项目经理三天培训，在自己熟悉的领域弥补起跑线之遗憾，好好享受赛道之美。万事开头难，但顺势而为，坚持到底，总能乘风破浪。dgiot将不负社会和政府的倾力支持，努力用好多年物联网领域经验，用好投资人和政府资助的财力和物力支持，用心做好每一期培训，为社会输送更多的物联网工程师，让更多的企业取得物联网商业成功，让起跑线、跑道和终点都变得更美好。

最后，欢迎K12赛道投资者改道开源项目职业教育赛道，这才是未来教育投资的正确赛道。

### 职业教育
![iot_project_train.jpg](http://dgiot-1253666439.cos.ap-shanghai-fsi.myqcloud.com/market/iot_project_train.jpg)

### MODBUS
在尝试任何设备的接入之前，首先要清楚需要做什么。
连接任何设备都离不开三个点：传感器设备、DTU、平台。传感器与DTU保持一个通讯，通过特定代码获得传感器数据。那这个特定代码就是我们配置的产品物模型，接着平台通过指令通道下发封装后的指令到DTU，DTU完成与传感器的数据交互在反馈给平台实现闭环。
理解后设备连接也简单，两个设备通上电，然后用线把两个传感器的485口对接就完成了。接下去就开始读产品说明书，串口4项数据贯通DTU和传感器的通讯。然后将DTU设置连接到你的服务器上，找一个空闲通道号设置好。
接着按实际情况为这个通道号配上合适的采集通道。加上两个公用的通道就能完成了。然后在产品里配置物模型。对于物模型而言，所需数据在说明书内都可以找到，实在不行让厂家提供收发代码，看懂格式填进去就可以了。
最后把几个通道配进去，重启通道和产品就可以了。设备不上线你重启刷新，看看通道日志有没有DTU发数据上来。部分文档后面都有排错的方法。实在无法解决可以去github下Issues留言或者网页下面留言。

多个基于Modbus协议的传感设备由一个DTU进行监管：
1.获得多个设备时，先逐一查看各设备串口信息，包括波特率、数据位、校验位、停止位。之后用485转usb连接电脑与设备，并在电脑上下载串口调试工具。在确保建立连接成功后，按照说明书的提示向该设备发送指令做出反应。完成后记录指令的数据。
2.当你完成各个传感设备的检测后，我们会获得两组数据：串口数据、指令数据。首先我们将各设备的串口数据进行对比，必须确保它们相同。如若发现部分串口数据不同，则自行按照最优方式将其同步。下一步是对地址码的校验，地址码是指从机的地址即下发指令的第一字节（8位）。
为防止各设备信息查询发生冲突，必须保证每一个传感器设备对应的地址吗都不相同。发生冲突时自行按说明书代码进行更改。
3.当完成多个传感器信息调整后，将这些传感器485线连在一起后对接485转usb串口。在电脑上进行最后一次测试，保证发送的每条查询指令都能得到设备的应答。
4.将传感设备连接到DTU上，对DTU串口、端口等进行配置。然后在平台的产品内配置物模型（填写的数据参考指令代码）。


# 什么是Modbus?

Modbus是一种串行通讯协议，是Modicon公司(现在的施耐德电气 Schneider Electric) 于1979年为使用可编程逻辑控制器(PLC)通信而发表。Modbus已经成为工业领域通信协议事实上的业界标准，并且现在是工业电子设备之间常见的连接方式。

Modbus在工业环境下很流行，因为它是公开发布而免版税的。它是为工业应用开发的，与其他标准相比，它相对易于部署和维护，除了要传输的数据格式的大小外，几乎没有其他限制。Modbus使用RS485作为其物理层。

Modbus支持连接到同一网络的许多设备之间进行通信，例如，一个测量温度和湿度并将结果发送给服务器的系统中，Modbus通常用于在监控和数据采集(SCADA)系统中将计算机或服务器与远程终端单元(RTU)连接。许多数据类型是根据梯形逻辑(一种通过基于继电器逻辑电路图的图形来代表程序的一种编程语言)的行业用法机及其在驱动继电器中的用途来命名的: 单位物理输出称为线圈，单位物理输入称为离散输入或触点。

![Devices-Communicate-Using-Modbus-Common-Language.jpg](http://dgiot-1253666439.cos.ap-shanghai-fsi.myqcloud.com/shuwa_tech/zh/blog/study/modbus/Devices-Communicate-Using-Modbus-Common-Language.jpg)

Modbus协议在RS232，RS422和RS485之上运行。有针对Modbus帧的基于IP链路层定义的 Modbus/TCP规范。Modbus协议基于Request(请求)/Response(响应)模型。

# Modbus通信协议的类型

串行端口和以太网存在多种版本的Modbus协议，最常见的是：

- Modbus RTU
- Modbus ASCII
- Modbus TCP
- Modbus Plus

更详细请下载[Modbus协议文档完整版本](http://dgiot-1253666439.cos.ap-shanghai-fsi.myqcloud.com/shuwa_tech/zh/blog/study/modbus/Modbus_book.pdf)

![Modbus-Different-Types.jpg](http://dgiot-1253666439.cos.ap-shanghai-fsi.myqcloud.com/shuwa_tech/zh/blog/study/modbus/Modbus-Different-Types.jpg)

Modicon发布了基于主从架构的多点网络的Modbus通信接口。Modbus节点之间的通信通过发送请求和读取响应类型消息来实现。

# Modbus协议及其物理媒体

Modbus是描述消息通信对话框的开放标准。

Modbus通过多种类型的物理介质进行通信，例如：

- 串行RS-232

- 串行RS-485

- 串行RS-422

- 以太网

![Modbus-Communication-Physical-Media.gif](http://dgiot-1253666439.cos.ap-shanghai-fsi.myqcloud.com/shuwa_tech/zh/blog/study/modbus/Modbus-Communication-Physical-Media.gif)

最初的Modbus接口在RS-232串行通信上运行，但是大多数后来的Modbus实现使用RS-485，因为它允许：

- 距离更长。

- 更高的速度。

- 单个多点网络中可能有多个设备。

![Modbus-Communication-over-Serial-RS485-Benefits-.jpg](http://dgiot-1253666439.cos.ap-shanghai-fsi.myqcloud.com/shuwa_tech/zh/blog/study/modbus/Modbus-Communication-over-Serial-RS485-Benefits-.jpg)

使用两线制通过串行RS-485物理介质进行主从Modbus通信 发送 并接收连接。

![Modbus-Communication-over-Serial-RS-485-Physical-Media.jpg](http://dgiot-1253666439.cos.ap-shanghai-fsi.myqcloud.com/shuwa_tech/zh/blog/study/modbus/Modbus-Communication-over-Serial-RS-485-Physical-Media.jpg)

在简单的接口（如RS232或RS485）上，Modbus消息以纯格式通过网络发送，并且该网络将专用于Modbus通信。

但是，如果您的网络需要使用功能更广泛的网络系统（例如以太网上的TCP / IP）使用多个异构设备，则Modbus消息将以此物理接口规定的格式嵌入到以太网数据包中。

因此，在这种情况下，Modbus和其他类型的混合协议可以同时存在于同一物理接口上。

![Modbus-Devices-Compliance-with-Ethernet-Physical-Interface.gif](http://dgiot-1253666439.cos.ap-shanghai-fsi.myqcloud.com/shuwa_tech/zh/blog/study/modbus/Modbus-Devices-Compliance-with-Ethernet-Physical-Interface.gif)

# Modbus4j

官网地址: https://infiniteautomation.com/modbus4j-open-source-modbus-library/

GitHub：https://github.com/infiniteautomation/modbus4j

由Infinite Automation Systems和Serotonin Software用Java编写的Modbus协议的高性能和易用性实现。支持ASCII，RTU，TCP和UDP传输作为从属或主用，自动请求分区和响应数据类型解析。

现在可以使用最新版本的公共Maven存储库，将其添加到pom.xml中

```xml
<repositories>
    <repository>
        <releases>
            <enabled>false</enabled>
        </releases>
        <snapshots>
            <enabled>true</enabled>
        </snapshots>
        <id>ias-snapshots</id>
        <name>Infinite Automation Snapshot Repository</name>
        <url>https://maven.mangoautomation.net/repository/ias-snapshot/</url>
    </repository>
    <repository>
        <releases>
            <enabled>true</enabled>
        </releases>
        <snapshots>
            <enabled>false</enabled>
        </snapshots>
        <id>ias-releases</id>
        <name>Infinite Automation Release Repository</name>
        <url>https://maven.mangoautomation.net/repository/ias-release/</url>
    </repository>
</repositories>
```

依赖项信息为：
```xml
<dependency>
    <groupId>com.infiniteautomation</groupId>
    <artifactId>modbus4j</artifactId>
    <version>3.0.3</version>
</dependency>
```
Modbus效果演示视频
<video src="http://dgiot-1253666439.cos.ap-shanghai-fsi.myqcloud.com/shuwa_tech/zh/blog/study/modbus/gateway-modbus.mp4" width="800px" height="600px" controls="controls"></video>


## modbus功能码定义和样例

modbus完整支持很多功能码，但是实际在应用的时候常用的也就那么几个。具体如下：

+ 0x01: 读线圈寄存器  
+ 0x02: 读离散输入寄存器  
+ 0x03: 读保持寄存器  
+ 0x04: 读输入寄存器  
+ 0x05: 写单个线圈寄存器  
+ 0x06: 写单个保持寄存器  
+ 0x0f: 写多个线圈寄存器  
+ 0x10: 写多个保持寄存器  

如上所示一共8种功能码。这其中有涉及到线圈、离散输入、保持、输入四种寄存器。这名字也不知道谁起的，让人看了一点不通俗易懂，搞得晕晕乎乎。实际上你要是看清他的本质就很简单了。下面分别解释一下：

**线圈寄存器**：实际上就可以类比为开关量，每个bit都对应一个信号的开关状态。所以一个byte就可以同时控制8路的信号。比如控制外部8路io的高低。 线圈寄存器支持读也支持写，写在功能码里面又分为写单个线圈寄存器和写多个线圈寄存器。对应上面的功能码也就是：0x01 0x05 0x0f

**离散输入寄存器**：如果线圈寄存器理解了这个自然也明白了。离散输入寄存器就相当于线圈寄存器的只读模式，他也是每个bit表示一个开关量，而他的开关量只能读取输入的开关信号，是不能够写的。比如我读取外部按键的按下还是松开。所以功能码也简单就一个读的 0x02

**保持寄存器**：这个寄存器的单位不再是bit而是两个byte，也就是可以存放具体的数据量的，并且是可读写的。比如我我设置时间年月日，不但可以写也可以读出来现在的时间。写也分为单个写和多个写，所以功能码有对应的三个：0x03 0x06 0x10

**输入寄存器**：只剩下这最后一个了，这个和保持寄存器类似，但是也是只支持读而不能写。一个寄存器也是占据两个byte的空间。类比我我通过读取输入寄存器获取现在的AD采集值。对应的功能码也就一个 0x04

对应的错误返回：  
在对应功能码基础上加上0x80

1、“01”读取线圈状态发送：

![在这里插入图片描述](https://img-blog.csdnimg.cn/20190114112103377.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2xpYm94aXU=,size_16,color_FFFFFF,t_70)

2、“02”读取输入状态  
![在这里插入图片描述](https://img-blog.csdnimg.cn/20190114112147249.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2xpYm94aXU=,size_16,color_FFFFFF,t_70)![在这里插入图片描述](https://img-blog.csdnimg.cn/20190114112206761.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2xpYm94aXU=,size_16,color_FFFFFF,t_70)

3、“03”保持型寄存器读取

![在这里插入图片描述](https://img-blog.csdnimg.cn/20190114112255339.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2xpYm94aXU=,size_16,color_FFFFFF,t_70)

![在这里插入图片描述](https://img-blog.csdnimg.cn/20190114112504699.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2xpYm94aXU=,size_16,color_FFFFFF,t_70)  
![在这里插入图片描述](https://img-blog.csdnimg.cn/20190114112524280.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2xpYm94aXU=,size_16,color_FFFFFF,t_70)  
![在这里插入图片描述](https://img-blog.csdnimg.cn/20190114112623947.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2xpYm94aXU=,size_16,color_FFFFFF,t_70)  
![在这里插入图片描述](https://img-blog.csdnimg.cn/20190114112649191.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2xpYm94aXU=,size_16,color_FFFFFF,t_70)  
![在这里插入图片描述](https://img-blog.csdnimg.cn/2019011411271481.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2xpYm94aXU=,size_16,color_FFFFFF,t_70)![在这里插入图片描述](https://img-blog.csdnimg.cn/20190114112732156.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2xpYm94aXU=,size_16,color_FFFFFF,t_70)![在这里插入图片描述](https://img-blog.csdnimg.cn/20190114112747704.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2xpYm94aXU=,size_16,color_FFFFFF,t_70)![在这里插入图片描述](https://img-blog.csdnimg.cn/20190114112803875.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2xpYm94aXU=,size_16,color_FFFFFF,t_70)

## 表1 ModBus功能码

|   |   | |
| ------------ | ------------ |----|
|  功能码 | 名称  | 作用|
|功能码  |  名称                    |  作用 |
|01      |读取线圈状态              |取得一组逻辑线圈的当前状态（ON/OFF)|
|02      |读取输入状态              |取得一组开关输入的当前状态（ON/OFF)|
|03      |读取保持寄存器            | 在一个或多个保持寄存器中取得当前的二进制值|
|04      |读取输入寄存器            | 在一个或多个输入寄存器中取得当前的二进制值|
|05      |强置单线圈                |强置一个逻辑线圈的通断状态|
|06      |预置单寄存器              |把具体二进值装入一个保持寄存器|
|07      |读取异常状态              |取得8个内部线圈的通断状态，这8个线圈的地址由控制器决定，用户逻辑可以将这些线圈定义，以说明从机状态，短报文适宜于迅速读取状态|
|08      |回送诊断校验              |把诊断校验报文送从机，以对通信处理进行评鉴|
|09      |编程（只用于484）         |  使主机模拟编程器作用，修改PC从机逻辑|
|10      |控询（只用于484）         |  可使主机与一台正在执行长程序任务从机通信，探询该从机是否已完成其操作任务，仅在含有功能码9的报文发送后，本功能码才发送|
|11      |读取事件计数              |可使主机发出单询问，并随即判定操作是否成功，尤其是该命令或其他应答产生通信错误时|
|12      |读取通信事件记录          |可是主机检索每台从机的ModBus事务处理通信事件记录。如果某项事务处理完成，记录会给出有关错误|
|13      |编程（184/384 484 584）   |可使主机模拟编程器功能修改PC从机逻辑|
|14      |探询（184/384 484 584）   |可使主机与正在执行任务的从机通信，定期控询该从机是否已完成其程序操作，仅在含有功能13的报文发送后，本功能码才得发送|
|15      |强置多线圈                |强置一串连续逻辑线圈的通断|
|16      |预置多寄存器              |把具体的二进制值装入一串连续的保持寄存器|
|17      |报告从机标识              |可使主机判断编址从机的类型及该从机运行指示灯的状态|
|18      |（884和MICRO 84）         |可使主机模拟编程功能，修改PC状态逻辑|
|19      |重置通信链路              |发生非可修改错误后，是从机复位于已知状态，可重置顺序字节|
|20      |读取通用参数（584L）       |显示扩展存储器文件中的数据信息|
|21      |写入通用参数（584L）       |把通用参数写入扩展存储文件，或修改之|
|22～64  |                          |保留作扩展功能备用|
|65～72  |保留以备用户功能所用       |留作用户功能的扩展编码|
|73～119 |非法功能                  | |
|120～127|  保留                    |留作内部作用|
|128～255|  保留                    |用于异常应答|